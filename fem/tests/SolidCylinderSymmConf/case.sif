!---------------------------------------------------------
! This test case features conforming BC's for a vector valued
! problem. Rotational normals are needed to have consistent
! normals for the rotating boundaries. Small spring coefficients
! are used for (x,y) components since otherwise there is nothing
! to eliminate rigid body rotation around the axis. 
!
! P.R. 25.10.2025
!------------------------------------------------------------

Header
  Mesh DB "." "solidcyl"
  Include Path ""
  Results Directory ""
End 


Simulation
  Max Output Level = 7
  Coordinate System = Cartesian 
  Simulation Type = Steady
  Steady State Max Iterations = 1
  Output Intervals = 0

!  Mesh Levels = 2

 $suf="a" 
  Post File = case-$suf$.vtu
  Ascii Output = True
End


Body 1
  Name = "Body"
  Equation = 1
  Material = 1
  Body Force = 1
End

Equation 1
  Name = "Elasticity"
  Active Solvers(1) = 1 
End

Material 1
  Name = "Ideal"
  Poisson Ratio = Real 0.3
  Youngs Modulus = Real 100.0
End

Solver 1
  Equation = LinElast
  Variable = -dofs 3 Displacement
  Procedure = "StressSolve" "StressSolver"

  Nonlinear System Max Iterations = 1
  Nonlinear System Consistent Norm = Logical True

  Linear System Solver = "Iterative"
  Linear System Preconditioning = BILU4
  Linear System Max Iterations = 1000
  Linear System Convergence Tolerance = 1e-7
  Linear System Iterative Method = idrs
  Linear System Residual Output = 20

  Linear System Timing = True
  Solver Timing = True
 
  Apply Conforming BCs = True
  Displace Mesh = Logical False
End 


Body Force 1
  Stress Bodyforce 1 = Equals "Coordinate 1"
  Stress Bodyforce 2 = Equals "Coordinate 2"
End 

Boundary Condition 1
  Name = "Zend"
  Target Boundaries(1) = 1
! We need to fix u_z somewhere.
  Displacement 3 = 0.0

$k=1.0e-2
  Spring 1 = Real $k 
  Spring 2 = Real $k
End

Boundary Condition 2
  Name = "Zstart"
  Target Boundaries(1) = 3
!  Displacement 3 = 0.0
End

Boundary Condition 3
  Name = "y-zero"
  Target Boundaries(1) = 8

  Conforming BC = 4 
!  Anti Radial Projector = True
  Radial Projector = True
  Rotational Normals = True
  Normal-Tangential Displacement = True
End

Boundary Condition 4
  Name = "x-zero"
  Target Boundaries(1) = 7
  Rotational Normals = True
  Normal-Tangential Displacement = True
End


Solver 1:: Reference Norm = 5.81170144E-03
