Check Keywords "Warn"

Header
Mesh DB "." "shoebox_tets"
End

Simulation
  Max Output Level = 12
  Coordinate System = "Cartesian"
  Simulation Type = Steady
  Steady State Max Iterations = 1
  Output Intervals(1) = 1
!  Mesh Levels = 2
End

Constants
!Permeability of Vacuum = Real 1
!Permittivity of Vacuum = Real 1
End

Body 1
  Equation = 1
  Material = 1
  Initial Condition = 1
End

$ beta0=41.9332032192090
$ k0=52.3961255469564
$ kc=31.4159265358979 
$ w=2*pi*(2.5e9)
$ mu0=4e-7*pi


Material 1
  Relative Permittivity = Real 1
End

Equation 1
  Active Solvers(3) = 1 2 3 
  Angular Frequency = Real $w
End


Solver 1
  Equation = "VectorHelmholtz"
  Use Piola Transform = True
  Second Kind Basis = True
  Element = "n:0 e:2"
  Procedure = "VectorHelmholtz" "VectorHelmholtzSolver"

  Linear System Symmetric = False
  Linear System Scaling = False
  Block Scaling = False

  Linear System Solver = String "Iterative"
  Linear System Iterative Method = String "gcr"
  Linear System Convergence Tolerance = 1.0e-7
  Linear System Residual Output = 1
  Linear system abort not converged = false
!  Linear System Scaling = False
  Linear System Max Iterations = 500

  Linear System Preconditioning = "slave"

  Linear System Complex = True

! Needed for precondutioner "slave"
  Exported Variable 1 = -dofs 2 e res
  Exported Variable 2 = -dofs 2 e update
  Prec Solvers(1) = Integer 2
  Preconditioning Residual = String "e res"
  Preconditioning Update = String "e update"

!  MG Smoother = csgs
!  MG Smoother Normalize Guess = Logical True 
!  MG Post Smoothing Iterations = 10
!  MG Smoother Relaxation Factor = Real $2.0/3.0
End



Solver 2
! use as slave solver only  
  exec solver = never

  Equation = "VectorHelmholtzNodal"
  Procedure = "VectorHelmholtzNodal" "VectorHelmholtzNodal"

  Preconditioning Solver = Logical True
!  Monolithic Solver = Logical True
  Edge Residual Name = String "e res"
  Edge Update Name = String "e update"

  Linear System Symmetric = False
!  Linear System Scaling = False
  Linear System Solver = "Iterative"
  Linear System Iterative Method = String "bicgstab2"
  BiCGstabl polynomial degree = Integer 4  
  Linear System Preconditioning = String "ILU1"
  Linear System Max Iterations = Integer 1000
  Linear System Convergence Tolerance = 1.0e-7
  Linear system abort not converged = false
  Linear System Residual Output = 10

  Nonlinear System Max Iterations = 1

  Skip Compute Nonlinear Change = True
End

Solver 3
  Equation = "calcfields"

  Procedure = "VectorHelmholtz" "VectorHelmholtzCalcFields"

  Calculate Nodal fields = True
  Calculate Elemental Fields = False
  Calculate Magnetic Field Strength = False
  Calculate Magnetic Flux Density = False
  Calculate Electric field = True
  Calculate Energy Functional = True

  Steady State Convergence Tolerance = 1
  Linear System Solver = "Iterative"
  Linear System Preconditioning = None
  Linear System Residual Output = 10
  Linear System Max Iterations = 5000
  Linear System Iterative Method = CG
  Linear System Convergence Tolerance = 1.0e-9
  !Exported Variable 1 = -dofs 3 Eref_re
End



Solver 4
  Equation = "VtuOutput"
  Procedure = "ResultOutputSolve" "ResultOutputSolver"
  Output File Name = slave-gcr
  Vtu Format = Logical True
  Save Geometry Ids = True
End 

Boundary Condition 1
  Name = "Inlet"
  Target Boundaries(1) = 1
  Electric Robin Coefficient im = Real $ beta0
!  Magnetic Boundary Load 2 = Variable Coordinate 1
!    Real MATC "-2*beta0*k0/kc*sin(pi*tx/100e-3)"
  Magnetic Boundary Load Im 2 = Variable Coordinate 1
    Real MATC "2*beta0*sin(kc*tx)"
End

Boundary Condition 2
  Name = "Outlet"
  Target Boundaries(1) = 6
  Absorbing BC = Logical True
End

Boundary Condition 3
  Target Boundaries(2) = 3 5
  PEX re = Real 0
  PEZ re = Real 0
  PEX im = Real 0
  PEZ im = Real 0
End

Boundary Condition 4
  Target Boundaries(2) = 2 4
  PEX re = Real 0
  PEY re = Real 0
  PEZ re = Real 0
  PEX im = Real 0
  PEY im = Real 0
  PEZ im = Real 0
End


Solver 1 :: Reference Norm = 0.73506158E-02
Solver 1 :: Reference Norm Tolerance = 1e-3
Solver 2 :: Reference Norm = 2.32743791E-03
Solver 2 :: Reference Norm Tolerance = 1e-3
